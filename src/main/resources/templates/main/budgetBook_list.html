<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/layout/mainLayout}" th:with="pageTitle='가계부 조회 : 돈매니저'">
<th:block layout:fragment="main">
    <main class="page page-budget-list">
        <!-- 날짜 선택 -->
        <h1 class="budget-date" th:attr="data-type=${type}">
            [[${title}]]
            <svg class="icon icon--calendar" viewBox="0 0 17 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M1.375 14.25C1.375 14.4489 1.45402 14.6397 1.59467 14.7803C1.73532 14.921 1.92609 15 2.125 15H14.625C14.8239 15 15.0147 14.921 15.1553 14.7803C15.296 14.6397 15.375 14.4489 15.375 14.25V5.5H1.375V14.25ZM11.375 6.625C11.375 6.59185 11.3882 6.56005 11.4116 6.53661C11.4351 6.51317 11.4668 6.5 11.5 6.5H12.75C12.7832 6.5 12.8149 6.51317 12.8384 6.53661C12.8618 6.56005 12.875 6.59185 12.875 6.625V7.875C12.875 7.90815 12.8618 7.93995 12.8384 7.96339C12.8149 7.98683 12.7832 8 12.75 8H11.5C11.4668 8 11.4351 7.98683 11.4116 7.96339C11.3882 7.93995 11.375 7.90815 11.375 7.875V6.625ZM11.375 9.125C11.375 9.09185 11.3882 9.06005 11.4116 9.03661C11.4351 9.01317 11.4668 9 11.5 9H12.75C12.7832 9 12.8149 9.01317 12.8384 9.03661C12.8618 9.06005 12.875 9.09185 12.875 9.125V10.375C12.875 10.4082 12.8618 10.4399 12.8384 10.4634C12.8149 10.4868 12.7832 10.5 12.75 10.5H11.5C11.4668 10.5 11.4351 10.4868 11.4116 10.4634C11.3882 10.4399 11.375 10.4082 11.375 10.375V9.125ZM8.875 6.625C8.875 6.59185 8.88817 6.56005 8.91161 6.53661C8.93505 6.51317 8.96685 6.5 9 6.5H10.25C10.2832 6.5 10.3149 6.51317 10.3384 6.53661C10.3618 6.56005 10.375 6.59185 10.375 6.625V7.875C10.375 7.90815 10.3618 7.93995 10.3384 7.96339C10.3149 7.98683 10.2832 8 10.25 8H9C8.96685 8 8.93505 7.98683 8.91161 7.96339C8.88817 7.93995 8.875 7.90815 8.875 7.875V6.625ZM8.875 9.125C8.875 9.09185 8.88817 9.06005 8.91161 9.03661C8.93505 9.01317 8.96685 9 9 9H10.25C10.2832 9 10.3149 9.01317 10.3384 9.03661C10.3618 9.06005 10.375 9.09185 10.375 9.125V10.375C10.375 10.4082 10.3618 10.4399 10.3384 10.4634C10.3149 10.4868 10.2832 10.5 10.25 10.5H9C8.96685 10.5 8.93505 10.4868 8.91161 10.4634C8.88817 10.4399 8.875 10.4082 8.875 10.375V9.125ZM8.875 11.625C8.875 11.5918 8.88817 11.5601 8.91161 11.5366C8.93505 11.5132 8.96685 11.5 9 11.5H10.25C10.2832 11.5 10.3149 11.5132 10.3384 11.5366C10.3618 11.5601 10.375 11.5918 10.375 11.625V12.875C10.375 12.9082 10.3618 12.9399 10.3384 12.9634C10.3149 12.9868 10.2832 13 10.25 13H9C8.96685 13 8.93505 12.9868 8.91161 12.9634C8.88817 12.9399 8.875 12.9082 8.875 12.875V11.625ZM6.375 9.125C6.375 9.09185 6.38817 9.06005 6.41161 9.03661C6.43505 9.01317 6.46685 9 6.5 9H7.75C7.78315 9 7.81495 9.01317 7.83839 9.03661C7.86183 9.06005 7.875 9.09185 7.875 9.125V10.375C7.875 10.4082 7.86183 10.4399 7.83839 10.4634C7.81495 10.4868 7.78315 10.5 7.75 10.5H6.5C6.46685 10.5 6.43505 10.4868 6.41161 10.4634C6.38817 10.4399 6.375 10.4082 6.375 10.375V9.125ZM6.375 11.625C6.375 11.5918 6.38817 11.5601 6.41161 11.5366C6.43505 11.5132 6.46685 11.5 6.5 11.5H7.75C7.78315 11.5 7.81495 11.5132 7.83839 11.5366C7.86183 11.5601 7.875 11.5918 7.875 11.625V12.875C7.875 12.9082 7.86183 12.9399 7.83839 12.9634C7.81495 12.9868 7.78315 13 7.75 13H6.5C6.46685 13 6.43505 12.9868 6.41161 12.9634C6.38817 12.9399 6.375 12.9082 6.375 12.875V11.625ZM3.875 9.125C3.875 9.09185 3.88817 9.06005 3.91161 9.03661C3.93505 9.01317 3.96685 9 4 9H5.25C5.28315 9 5.31495 9.01317 5.33839 9.03661C5.36183 9.06005 5.375 9.09185 5.375 9.125V10.375C5.375 10.4082 5.36183 10.4399 5.33839 10.4634C5.31495 10.4868 5.28315 10.5 5.25 10.5H4C3.96685 10.5 3.93505 10.4868 3.91161 10.4634C3.88817 10.4399 3.875 10.4082 3.875 10.375V9.125ZM3.875 11.625C3.875 11.5918 3.88817 11.5601 3.91161 11.5366C3.93505 11.5132 3.96685 11.5 4 11.5H5.25C5.28315 11.5 5.31495 11.5132 5.33839 11.5366C5.36183 11.5601 5.375 11.5918 5.375 11.625V12.875C5.375 12.9082 5.36183 12.9399 5.33839 12.9634C5.31495 12.9868 5.28315 13 5.25 13H4C3.96685 13 3.93505 12.9868 3.91161 12.9634C3.88817 12.9399 3.875 12.9082 3.875 12.875V11.625ZM14.625 2H12.8775V1H11.3775V2H5.3725V1H3.8725V2H2.125C2.02688 1.99918 1.92957 2.01777 1.83868 2.05472C1.74778 2.09167 1.66509 2.14624 1.59538 2.21529C1.52566 2.28433 1.4703 2.36649 1.43248 2.45703C1.39465 2.54757 1.37512 2.64469 1.375 2.74281V4.5H15.375V2.74281C15.3749 2.64469 15.3553 2.54757 15.3175 2.45703C15.2797 2.36649 15.2243 2.28433 15.1546 2.21529C15.0849 2.14624 15.0022 2.09167 14.9113 2.05472C14.8204 2.01777 14.7231 1.99918 14.625 2Z"/>
            </svg>
        </h1>

        <!-- 금액 통계 -->
        <dl class="budget-stats">
            <div class="budget-stats__total">
                <dt>전체</dt>
                <dd th:text="${price['total'] == 0 ? '0원' : #numbers.formatInteger(price['total'], 3, 'COMMA') + '원'}"></dd>
            </div>
            <div class="budget-stats__income">
                <dt>수입</dt>
                <dd th:text="${price['income'] == null ? '0원' : #numbers.formatInteger(price['income'], 3 , 'COMMA') + '원'}"></dd>
            </div>
            <div class="budget-stats__outlay">
                <dt>지출</dt>
                <dd th:text="${price['outlay'] == null ? '0원' : #numbers.formatInteger(price['outlay'], 3, 'COMMA') + '원'}"></dd>
            </div>
        </dl>

        <!-- 그래프 -->
        <details class="budget-graph">
            <summary class="budget-graph__title">
                그래프보기
                <span class="budget-graph__icon">▼</span>
            </summary>
            <div class="budget-graph__content"></div>
        </details>

        <!-- 메뉴 -->
        <section class="budget-menu">
            <!-- 기본 메뉴 영역 -->
            <section class="budget-menu__top">
                <!-- 탭 -->
                <nav class="budget-menu__filter">
                    <ul class="budget-menu__list">
                        <li class="budget-menu__item" th:classappend="${search.mode == 'all'} ? 'budget-menu__item--active'" th:attr="data-mode='all'">
                            <button class="button">전체</button>
                        </li>
                        <li class="budget-menu__item" th:classappend="${search.mode == 'inout'} ? 'budget-menu__item--active'" th:attr="data-mode='inout'">
                            <button class="button">수입/지출</button>
                        </li>
                        <li class="budget-menu__item" th:classappend="${search.mode == 'category'} ? 'budget-menu__item--active'" th:attr="data-mode='category'">
                            <button class="button">카테고리</button>
                        </li>
                        <li class="budget-menu__item" th:classappend="${search.mode == 'memo'} ? 'budget-menu__item--active'" th:attr="data-mode='memo'">
                            <button class="button">메모</button>
                        </li>
                        <li class="budget-menu__item" th:classappend="${search.mode == 'period'} ? 'budget-menu__item--active'" th:attr="data-mode='period'">
                            <button class="button">기간</button>
                        </li>
                    </ul>
                </nav>

                <!-- 삭제 버튼 -->
                <div class="budget-menu__action">
                    <button class="button button--delete">
                        <svg class="icon icon--basket" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6.875 0.9375V1.5625H9.0625C9.14538 1.5625 9.22487 1.59542 9.28347 1.65403C9.34208 1.71263 9.375 1.79212 9.375 1.875C9.375 1.95788 9.34208 2.03737 9.28347 2.09597C9.22487 2.15458 9.14538 2.1875 9.0625 2.1875H8.72625L8.19313 8.85C8.16798 9.16325 8.02578 9.45553 7.79483 9.66865C7.56388 9.88176 7.26113 10.0001 6.94687 10H3.05313C2.73887 10.0001 2.43612 9.88176 2.20517 9.66865C1.97422 9.45553 1.83202 9.16325 1.80687 8.85L1.27375 2.1875H0.9375C0.85462 2.1875 0.775134 2.15458 0.716529 2.09597C0.657924 2.03737 0.625 1.95788 0.625 1.875C0.625 1.79212 0.657924 1.71263 0.716529 1.65403C0.775134 1.59542 0.85462 1.5625 0.9375 1.5625H3.125V0.9375C3.125 0.68886 3.22377 0.450403 3.39959 0.274587C3.5754 0.098772 3.81386 0 4.0625 0L5.9375 0C6.18614 0 6.4246 0.098772 6.60041 0.274587C6.77623 0.450403 6.875 0.68886 6.875 0.9375ZM3.75 0.9375V1.5625H6.25V0.9375C6.25 0.85462 6.21708 0.775134 6.15847 0.716529C6.09987 0.657924 6.02038 0.625 5.9375 0.625H4.0625C3.97962 0.625 3.90013 0.657924 3.84153 0.716529C3.78292 0.775134 3.75 0.85462 3.75 0.9375ZM2.8125 3.14312L3.125 8.45563C3.12667 8.49715 3.1366 8.53793 3.15422 8.57557C3.17184 8.61321 3.1968 8.64696 3.22762 8.67484C3.25844 8.70272 3.29452 8.72417 3.33373 8.73794C3.37295 8.75171 3.41452 8.75751 3.456 8.75502C3.49749 8.75253 3.53806 8.74178 3.57534 8.72341C3.61263 8.70505 3.64587 8.67943 3.67313 8.64806C3.70039 8.61668 3.72112 8.58019 3.73411 8.54071C3.74709 8.50123 3.75207 8.45955 3.74875 8.41813L3.43625 3.10562C3.43458 3.0641 3.42465 3.02332 3.40703 2.98568C3.38941 2.94804 3.36445 2.91429 3.33363 2.88641C3.30281 2.85853 3.26673 2.83708 3.22752 2.82331C3.1883 2.80954 3.14673 2.80374 3.10525 2.80623C3.06376 2.80872 3.02319 2.81947 2.98591 2.83784C2.94862 2.8562 2.91538 2.88182 2.88812 2.91319C2.86086 2.94456 2.84013 2.98106 2.82714 3.02054C2.81416 3.06002 2.80918 3.1017 2.8125 3.14312ZM6.89375 2.81312C6.81104 2.80834 6.72982 2.8366 6.66794 2.89169C6.60606 2.94677 6.56858 3.02417 6.56375 3.10688L6.25125 8.41937C6.24857 8.50085 6.27783 8.58015 6.33279 8.64035C6.38775 8.70056 6.46407 8.7369 6.54545 8.74163C6.62683 8.74636 6.70684 8.7191 6.76841 8.66567C6.82998 8.61224 6.86823 8.53686 6.875 8.45563L7.1875 3.14312C7.19228 3.06042 7.16402 2.9792 7.10894 2.91731C7.05386 2.85543 6.97645 2.81796 6.89375 2.81312ZM5 2.8125C4.91712 2.8125 4.83763 2.84542 4.77903 2.90403C4.72042 2.96263 4.6875 3.04212 4.6875 3.125V8.4375C4.6875 8.52038 4.72042 8.59987 4.77903 8.65847C4.83763 8.71708 4.91712 8.75 5 8.75C5.08288 8.75 5.16237 8.71708 5.22097 8.65847C5.27958 8.59987 5.3125 8.52038 5.3125 8.4375V3.125C5.3125 3.04212 5.27958 2.96263 5.22097 2.90403C5.16237 2.84542 5.08288 2.8125 5 2.8125Z" />
                        </svg>
                    </button>
                </div>
            </section>
        </section>

        <!-- 내역 리스트 -->
        <article class="budget-list" th:classappend="${#maps.isEmpty(summary)} ? 'empty' : 'filled'">
            <!-- 내역 없는 상태 -->
            <div th:if="${summary == null or #maps.isEmpty(summary)}">
                <span>아직 등록된 내역이 없어요.</span>
                <svg class="icon icon--sad" viewBox="0 0 51 51" xmlns="http://www.w3.org/2000/svg">
                    <path d="M25.625 6.74967C23.1628 6.74967 20.7246 7.23466 18.4497 8.17693C16.1749 9.11921 14.1079 10.5003 12.3668 12.2414C10.6257 13.9825 9.24457 16.0495 8.3023 18.3244C7.36002 20.5992 6.87504 23.0374 6.87504 25.4997C6.87504 27.962 7.36002 30.4001 8.3023 32.675C9.24457 34.9498 10.6257 37.0168 12.3668 38.7579C14.1079 40.499 16.1749 41.8801 18.4497 42.8224C20.7246 43.7647 23.1628 44.2497 25.625 44.2497C30.5978 44.2497 35.367 42.2742 38.8833 38.7579C42.3996 35.2416 44.375 30.4725 44.375 25.4997C44.375 20.5269 42.3996 15.7577 38.8833 12.2414C35.367 8.72511 30.5978 6.74967 25.625 6.74967ZM2.70837 25.4997C2.70837 12.8434 12.9688 2.58301 25.625 2.58301C38.2813 2.58301 48.5417 12.8434 48.5417 25.4997C48.5417 38.1559 38.2813 48.4163 25.625 48.4163C12.9688 48.4163 2.70837 38.1559 2.70837 25.4997ZM21.9438 21.0538L14.7271 25.2205L12.6438 21.6122L19.8605 17.4455L21.9438 21.0538ZM31.3938 17.4455L38.6105 21.6122L36.5271 25.2205L29.3105 21.0538L31.3938 17.4455ZM16.6021 32.7893C17.5168 31.2058 18.8322 29.8911 20.416 28.9772C21.9999 28.0633 23.7964 27.5825 25.625 27.583C27.4535 27.5831 29.2497 28.0644 30.8332 28.9786C32.4167 29.8929 33.7316 31.2078 34.6459 32.7913L35.6896 34.5934L32.0834 36.6788L31.0417 34.8768C30.4931 33.9257 29.7036 33.1359 28.7527 32.5869C27.8018 32.038 26.723 31.7492 25.625 31.7497C24.5273 31.749 23.4487 32.0374 22.4978 32.586C21.5469 33.1346 20.7573 33.924 20.2084 34.8747L19.1667 36.6788L15.5605 34.5934L16.6021 32.7893Z"/>
                </svg>
            </div>

            <!-- 내역 있는 상태 -->
            <div th:unless="${summary == null or #maps.isEmpty(summary)}" th:each="entry : ${summary}">
                <h2 class="budget-list__title" th:text="${entry.key}"></h2>

                <ul th:each="cardList : ${entry.value}" class="budget-list__cards">
                    <li th:each="card : ${cardList}" class="budget-card" th:classappend="${card == null ? 'empty' : (#strings.startsWith(card.code, '01') ? 'income' : 'outlay' )}">
                        <div class="budget-card__type"></div>
                        <div th:if="${card != null}" class="budget-card__icon" th:attr="data-pk=${card.id}">
                            <svg class="icon icon--box" viewBox="0 0 8 9"  xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M1.08333 0.25C0.86232 0.25 0.650358 0.337797 0.494078 0.494078C0.337797 0.650358 0.25 0.86232 0.25 1.08333V6.91667C0.25 7.13768 0.337797 7.34964 0.494078 7.50592C0.650358 7.6622 0.86232 7.75 1.08333 7.75H6.91667C7.13768 7.75 7.34964 7.6622 7.50592 7.50592C7.6622 7.34964 7.75 7.13768 7.75 6.91667V1.08333C7.75 0.86232 7.6622 0.650358 7.50592 0.494078C7.34964 0.337797 7.13768 0.25 6.91667 0.25H1.08333ZM6.0625 3.08167C6.14068 3.00354 6.18463 2.89755 6.18467 2.78702C6.18471 2.67649 6.14084 2.57048 6.06271 2.49229C5.98458 2.41411 5.87859 2.37016 5.76806 2.37012C5.65753 2.37008 5.55152 2.41395 5.47333 2.49208L3.41083 4.55458L2.52708 3.67083C2.4884 3.63212 2.44247 3.60141 2.39191 3.58045C2.34136 3.55948 2.28717 3.54868 2.23244 3.54867C2.12191 3.54863 2.01589 3.5925 1.93771 3.67063C1.85952 3.74875 1.81558 3.85474 1.81554 3.96527C1.8155 4.0758 1.85937 4.18182 1.9375 4.26L3.08667 5.40917C3.12923 5.45175 3.17977 5.48553 3.23539 5.50858C3.29101 5.53162 3.35063 5.54349 3.41083 5.54349C3.47104 5.54349 3.53066 5.53162 3.58628 5.50858C3.6419 5.48553 3.69244 5.45175 3.735 5.40917L6.0625 3.08167Z"/>
                            </svg>
                        </div>
                        <span class="budget-card__category" th:text="${card != null ? card.name : ''}"></span>
                        <span class="budget-card__price" th:text="${card != null ? #numbers.formatInteger(card.price, 3, 'COMMA') : ''}"></span>
                        <p class="budget-card__memo" th:text="${card != null ? card.memo : ''}"></p>
                    </li>
                </ul>
            </div>
        </article>
        <button class="button button--fab"></button>
    </main>
</th:block>
<th:block layout:fragment="pageScript">
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <script th:src="@{/js/jquery-ui.min.js}"></script>
    <script src="/js/google-charts-loader.js"></script>

    <script src="/js/pages/budgetBook-list.js"></script>
</th:block>
<th:block layout:fragment="pageStyle">
    <link rel="stylesheet" th:href="@{/css/jquery-ui.min.css}" />
</th:block>
</html>