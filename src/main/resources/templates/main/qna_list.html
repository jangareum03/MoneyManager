<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Q &amp; A : 돈매니저</title>
  <!-- css -->
  <link rel="stylesheet" th:href="@{/css/qna.css}">
  <!-- js -->
  <script th:src="@{/js/qna.js}"></script>
  <link rel="stylesheet" th:href="@{//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css}" type="text/css"/>
  <!-- jquery datepicker -->
  <script th:src="@{https://code.jquery.com/jquery-3.6.0.js}"></script>
  <script th:src="@{https://code.jquery.com/ui/1.13.2/jquery-ui.js}"></script>
  <script>
    $(function() {
      $("#start").datepicker({
        changeMonth: "true",
            changeYear: "true",
            showMonthAfterYear : "true",
            yearRange: "c-5:c",
            yearSuffix: "년",
            dateFormat: "yymmdd",
            dayNames: ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"],
            dayNamesMin: ["일", "월", "화", "수", "목", "금", "토"],
            monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
            monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
            nextText: "다음달",
            prevText: "이전달",
            maxDate: 0,
            onClose: function( selectedDate ) {
                $("#end").datepicker("option", "minDate", selectedDate);
            }
        });
    });

    $(function() {
        $("#end").datepicker({
            changeMonth: "true",
            changeYear: "true",
            yearRange: "c-5:c",
            yearSuffix: "년",
            dateFormat: "yymmdd",
            dayNames: ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"],
            dayNamesMin: ["일", "월", "화", "수", "목", "금", "토"],
            monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
            monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
            nextText: "다음달",
            prevText: "이전달",
            maxDate: 0
        });
    });
  </script>
</head>
<body class="body__wrap">
<nav th:replace="/include/menu.html :: nav"></nav>
<div class="div__wrap">
  <!-- 제목 -->
  <div class="header">
    <div class="header__title">
      Q&amp;A
    </div>
  </div>
  <!-- 검색 영역 -->
  <div class="search">
    <form method="get" th:action="@{/qna}" class="search__form">
      <select name="type" th:onclick="changeSearch( this )">
        <option th:value="all" th:selected="${search.type} == 'all'">전체</option>
        <option th:value="title" th:selected="${search.type} == 'title'">제목</option>
        <option th:value="writer" th:selected="${search.type} == 'writer'">작성자</option>
        <option th:value="period" th:selected="${search.type} == 'period'">기간</option>
      </select>
      <div class="search__option" th:style="${search.type == 'title' ? 'display:inline-flex' : 'display: none'}">
        <input type="text" class="input__text" placeholder="검색할 제목을 입력해주세요.">
        <button type="button" class="button__default" th:onclick="checkSearch()">검색</button>
      </div>
      <div class="search__option" th:style="${search.type == 'writer' ? 'display:inline-flex' : 'display: none'}">
        <input type="text" class="input__text" placeholder="검색할 작성자를 입력해주세요.">
        <button type="button" class="button__default" th:onclick="checkSearch()">검색</button>
      </div>
      <div class="search__option" th:style="${search.type == 'period' ? 'display:inline-flex' : 'display: none'}">
        시작일: <input type="text" class="input__text" id="start" readonly> - 종료일: <input type="text" class="input__text" id="end" readonly>
        <button type="button" class="button__default" th:onclick="checkSearch()">검색</button>
      </div>
    </form>
    <div class="search__button">
      <button type="button" class="button__default" th:onclick="location.href='/qna/write'">등록</button>
    </div>
  </div>
  <!-- 리스트 -->
  <div class="qna__list">
    <table class="qna__table">
      <thead class="qna__table__header">
      <tr>
        <th>번호</th>
        <th>제목</th>
        <th>날짜</th>
        <th>작성자</th>
      </tr>
      </thead>
      <tbody class="qna__table__body">
      <tr th:if="${#lists.size(qnaList)} == 0">
        <td colspan="4">등록된 글이 없습니다.</td>
      </tr>
      <tr th:unless="${#lists.size(qnaList)} == 0" th:each="qna : ${qnaList}">
        <td>[[${qna.num}]]</td>
        <td>
          <a th:if="${qna.open} == 'y'" th:href="@{/qna/detail/{id}(id = ${qna.id})}">[[${qna.title}]]</a>
          <a th:unless="${qna.open} == 'y'" th:qna="${qna.id}" th:onclick="checkMember( this.getAttribute('qna') )"><img src="/image/qnaLock.png" th:style="${'width: 20px;'}">비밀글입니다.</a>
        </td>
        <td th:text="${#dates.format(qna.regDate, 'yyyy-MM-dd')}"></td>
        <td>[[${qna.nickName}]]</td>
      </tr>
      </tbody>
    </table>
  </div>
  <!-- 페이징 -->
  <div class="paging" th:each="page : ${paging}">
    <ul>
      <li th:style="${page.isPrev ? 'display: inline' : 'display: none'}">
        <a th:href="@{/qna/(type=${search.type}, keyword=${search.keyword}, startDate=${search.startDate}, endDate=${search.endDate}, page = ${page.startPage - 1})}">&lt; </a>
      </li>
      <li th:each="num : ${#numbers.sequence( page.startPage, page.endPage )}">
        <span th:if="${num == now}">[[${num}]]</span>
        <a th:unless="${num == now}" th:href="@{/qna/(type=${search.type}, keyword=${search.keyword}, startDate=${search.startDate}, endDate=${search.endDate}, page=${num})}">[[${num}]]</a>
      </li>
      <li th:style="${page.isNext ? 'display: inline' : 'display: none'}">
        <a th:href="@{/qna/(type=${search.type}, keyword=${search.keyword}, startDate=${search.startDate}, endDate=${search.endDate}, page = ${page.endPage + 1})}"> &gt;</a>
      </li>
    </ul>
  </div>
</div>
</body>
</html>